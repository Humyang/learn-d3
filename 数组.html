<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <!-- <script src="https://d3js.org/d3.v4.min.js"></script> -->
    
    <script src="./jquery-3.3.1.min.js"></script>
    <script src="./d3/d3.min.js"></script>
    <title>数组</title>
    <style>
        body {
            background: #ddd;
        }

        .board {
            background: white;
            display: inline-block;
            padding: 25px;
        }
        .board code {
            background-color: #b3e677;
            padding: 5px;
        }
        p.process {
            background-color: #ff8980;
            padding: 5px 0px;
        }
    </style>
</head>
<script id="concat" type="text/template">
    <div class="board concat">
        <h1>Array.prototype.concat</h1>
        <p>Array1：<code>1,2,3</code></p>
        <p>Array2：<code>4,5,6</code></p>
        <p class="process">Array1.concat(Array2)</p>
        <p>Array1：<code>1,2,3,4,5,6</code></p>
        <svg class="svg1"></svg>
    </div>
</script>
<script id="copyWithin" type="text/template">
    <div class="board copyWithin">
        <h1>Array.prototype.copyWithin</h1>
        <p>Array1：<code>1,2,3</code></p>
        <p>Array2：<code>4,5,6</code></p>
        <p class="process">Array1.concat(Array2)</p>
        <p>Array1：<code>1,2,3,4,5,6</code></p>
        <svg class="svg1"></svg>
    </div>
</script>
<body> 
    <div id="wrapper">

    </div>
    
    <script>
        var wrapper = $("#wrapper")

        function concat(){
            wrapper.append($("#concat").html())

            let concatA = [1, 2, 3]
            let concatB = [4, 5, 6]
            renderAnimate('.concat svg.svg1',concatA,false)
            setTimeout(() => {
                concatA = concatA.concat(concatB)
                renderAnimate('.concat svg.svg1',concatA,true)
            }, 1000);
        }
        
        function copyWithin(){
            wrapper.append($("#copyWithin").html())

            let concatA = [1, 2,3,4,5,6]
            // let concatB = [4, 5, 6]
            renderAnimate('.copyWithin svg.svg1',concatA,false)
            setTimeout(() => {
                concatA = concatA.copyWithin(0,3)
                console.log(concatA)
                renderAnimate('.copyWithin svg.svg1',concatA,true)
            }, 1000);
        }

        function renderAnimate(element,data,isAnimate){
            let t = d3.transition()
                    .duration(750);
            
            var svg = d3.select(element)
            var width = "400px"
            var height = "60px"
            svg.attr("width", width).attr("height", height)   
            var g=svg.selectAll('g').data(data, function (d,i) { return d })
            
            g.attr('class', 'enter')
            
            var circle = g.enter().append('g')
            
            circle.attr('class', 'update')

            if(isAnimate){
                circle
                .attr('style', 'transform:translateY(-30px)')
                .transition(t)
                .attr('style', 'transform:translateY(0px)')
            }
            circle.append('circle')
                .attr('cy', '-50')
                .attr('r', '20')
                .style("fill-opacity", 0.2)
                .attr("dy", "50px")
                .attr('cx', function (d, i) {console.log(data,d,i); return 50 + i * 60 })
                .attr('cy', '30')
                .style("fill-opacity", 1)
                .text(function (d) { return d })
            
            circle.append('text')
                .text(function (d) { return d })
                .attr('y', '39')
                .attr('x', function (d, i) { return 50 + i * 60 })
                .attr('stroke', 'white')
                .attr('font-size', '22')

            g.exit().remove()
        }
        window.onload = function () {
            // concat()
            copyWithin()
        }
        
    </script>
</body>

</html>